<style>
    body {
        background-color: black;
    }
</style>
<canvas></canvas>
<script>
    const canvas = document.querySelector('canvas');
    const ctx = canvas.getContext("2d");

    canvas.width = 1024;
    canvas.height = 768;

    let x = canvas.width / 2;
    let y = canvas.height / 2;
    let velocidade = 3;
    let size = 25;
    const name = 'VocÃª';
    const comidas = [];

    function newColor() {
        const r = Math.floor(Math.random() * 255)
        const g = Math.floor(Math.random() * 255)
        const b = Math.floor(Math.random() * 255)
        return `rgba(${r},${g},${b}, 1)`;
    }

    function spawnFood(count) {
        for (let i = 0; i < count; i++) {
            comidas.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                cor: newColor()
            })
        }
    }

    function animate() {
        requestAnimationFrame(animate);

        //fundo
        ctx.fillStyle = "white";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        //comida
        comidas.forEach(item => {
            ctx.beginPath()
            ctx.arc(item.x, item.y, 10, 0, Math.PI * 2);
            ctx.fillStyle = item.cor
            ctx.fill();
        })

        //movendo personagem
        if (mouse.x > 0 && mouse.y > 0) {
            const yDistancia = mouse.y - y;
            const xDistancia = mouse.x - x;
            const angulo = Math.atan2(yDistancia, xDistancia);
            x += Math.cos(angulo) * velocidade;
            y += Math.sin(angulo) * velocidade;
        }

        //personagem
        ctx.beginPath()
        ctx.arc(x, y, size, 0, Math.PI * 2);
        ctx.fillStyle = 'rgba(0,0,255,0.3)'
        ctx.fill();

        ctx.fillStyle = 'white'
        ctx.font = '15px Arial';
        let xTexto = ctx.measureText(name).width;
        ctx.fillText(name, x - xTexto / 2, y + 3);

        //verifica se comeu
        const meuRaio = size / 2;
        for (let i = comidas.length - 1; i >= 0; i--) {
            let comida = comidas[i];

            let xDistancia = Math.abs(x - comida.x)
            let yDistancia = Math.abs(y - comida.y)
            console.log(yDistancia);
            console.log(xDistancia);
            if (yDistancia <= meuRaio && xDistancia <= meuRaio) { //comeu
                size++;
                comidas.splice(i, 1)
            }
        }

        //spanw comidas
        if (comidas.length <= 25)
            spawnFood(25)
    }

    const mouse = {
        x: 0,
        y: 0
    };
    window.addEventListener("mousemove", (e) => {
        mouse.x = e.clientX;
        mouse.y = e.clientY;
    })


    function start() {
        spawnFood(50);
        animate();
    }

    start();

</script>